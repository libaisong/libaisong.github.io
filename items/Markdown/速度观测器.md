# 速度观测器

速度环带宽衡量电机控制系统性能的重要指标之一，速度环响应越快，其轨迹跟踪性能就越好，抗扰动能力就越强，可以满足更多高要求的应用场景。通常来说，执行频率越高，速度环的带宽就可以越高，但实际使用时往往受到速度反馈信号噪音的影响，如果速度反馈中的噪音过大，会在转矩电流中引入幅值较大的谐波，从而引起电机振动和啸叫。对反馈速度进行低通滤波是常用的做法，但低通滤波会导致相位滞后，从而影响速度环带宽。要想实现既能对反馈速度滤波，又能保证速度环带宽不受影响，可以考虑使用速度观测器。   

## 速度观测器原理

电机的机械方程如下式所示，下式中，$\omega$为电机转速，$T_e$为电磁转矩，$T_L$为负载转矩，$J$为电机转动惯量。  

$$
J \frac{d \omega}{dt} = T_e - T_L
$$

令$\hat{\omega}$为电机转速估计值，${\hat{T}}_L$为负载转矩估计值，那么可以得到下式。   

$$
J \frac{d \hat{\omega}}{dt} = T_e - {\hat{T}}_L
$$

通过合理设计观测器，就可以得到观测的转速。  

## 速度观测器实现

本节给出一种速度观测器的简单实现方法。首先，先根据下式观测出负载转矩${\hat{T}}_L$，式中$\omega _c$代表观测器截止频率。  

$$
{\hat{T}}_L = \frac{\omega _c}{s + \omega _c}(T_e - J \frac{d \omega}{dt})
$$

然后根据下式就可以得到转速估计值$\hat{\omega}$。  

$$
\hat{\omega} = \frac{\omega _c}{s + \omega _c} \omega + \frac{s}{s + \omega _c} \frac{T_e}{Js}
$$

观测出的转速$\hat{\omega}$包含两部分，第一部分是实际转速的低通滤波值，通过低通滤波可以滤除高频噪声，第二部分转矩作用下的转速变化分量，这部分可以补偿第一部分因为低通滤波导致的相位滞后，从而达到了滤除噪声的同时保证速度环带宽不受影响。相信熟悉电机磁链观测器的小伙伴看到上面的公式会会心一笑。  

实际应用中，为了使滤波效果更好，使用的速度观测器远比上面给出的方法复杂，这里不再展开。  